{"ast":null,"code":"function generateOption(param, data, id) {\n  const xkey = param.x.label;\n  const ykey = param.y.label;\n  const xmap = new Map();\n  const xset = new Set();\n  const ymap = new Map();\n  const yset = new Set();\n  const hybridSet = new Set();\n  const hybridMap = new Map();\n  let option = {\n    legend: {},\n    tooltip: {},\n    dataset: {\n      source: []\n    },\n    xAxis: {\n      type: \"category\"\n    },\n    yAxis: {},\n    series: [],\n    tab: id,\n    id: param.id\n  };\n  data.map(item => {\n    let XKey = \"\";\n    Object.getOwnPropertyNames(item).forEach(function (val, idx, array) {\n      if (val === xkey) {\n        let xcount = xmap.get(item[val]) !== undefined ? xmap.get(item[val]) : 0;\n        xset.add(item[val]);\n        xmap.set(item[val], xcount + 1);\n        hybridSet.add(item[val]);\n        XKey = item[val];\n      }\n      if (val === ykey) {\n        let ycount = ymap.get(item[val]) !== undefined ? ymap.get(item[val]) : 0;\n        yset.add(item[val]);\n        ymap.set(item[val], ycount + 1);\n\n        // const XKey  = [...xset][xset.size - 1 ]\n        let hcount = hybridMap.get(XKey + \"|\" + item[val]) !== undefined ? hybridMap.get(XKey + \"|\" + item[val]) : 0;\n        hybridMap.set(XKey + \"|\" + item[val], hcount + 1);\n      }\n    });\n  });\n  const sourceData = [\"product\"];\n  // }\n  yset.forEach(val => sourceData.push(val));\n  option.dataset.source.push(sourceData);\n  xmap.forEach((value, index) => {\n    let data = [index];\n    yset.forEach(dimension => {\n      let title = index + \"|\" + dimension;\n      let fValue = hybridMap.get(title);\n      if (fValue === undefined) fValue = 0;\n      data.push(fValue);\n    });\n    option.dataset.source.push(data);\n  });\n  yset.forEach(() => {\n    option.series.push({\n      type: param.type\n    });\n  });\n  return option;\n}\nexport default generateOption;","map":{"version":3,"names":["generateOption","param","data","id","xkey","x","label","ykey","y","xmap","Map","xset","Set","ymap","yset","hybridSet","hybridMap","option","legend","tooltip","dataset","source","xAxis","type","yAxis","series","tab","map","item","XKey","Object","getOwnPropertyNames","forEach","val","idx","array","xcount","get","undefined","add","set","ycount","hcount","sourceData","push","value","index","dimension","title","fValue"],"sources":["/Users/clarence/Code/echart-report-ui/src/Utils/optionHandler.js"],"sourcesContent":["\nfunction generateOption(param, data,id) {\n  const xkey = param.x.label; \n  const ykey = param.y.label;\n  const xmap = new Map();\n  const xset = new Set();\n  const ymap = new Map();\n  const yset = new Set();\n  const hybridSet = new Set();\n  const hybridMap = new Map();\n  let option = {\n    legend: {},\n    tooltip: {},\n    dataset: {\n      source: [],\n    },\n    xAxis: { type: \"category\" },\n    yAxis: {},\n    series: [],\n    tab: id,\n    id: param.id\n  };\n  data.map((item)=>{\n     let XKey =\"\";\n     Object.getOwnPropertyNames(item).forEach(function(val, idx, array) {\n      if(val === xkey){\n        let xcount =\n          xmap.get(item[val]) !== undefined ? xmap.get(item[val]) : 0\n        xset.add(item[val]);\n        xmap.set(item[val], xcount+1)\n        hybridSet.add(item[val])\n        XKey= item[val]\n      }\n\n      if(val === ykey){\n        let ycount =\n          ymap.get(item[val]) !== undefined ? ymap.get(item[val]) : 0\n        yset.add(item[val]);\n        ymap.set(item[val], ycount+1)\n\n        // const XKey  = [...xset][xset.size - 1 ]\n        let hcount = hybridMap.get(XKey+\"|\"+item[val]) !== undefined ? hybridMap.get(XKey+\"|\"+item[val]) : 0;\n        hybridMap.set(XKey+\"|\"+item[val],hcount + 1)\n\n      }\n    });\n  })\n\n  const sourceData = [\"product\"]\n  // }\n  yset.forEach((val) => sourceData.push(val))\n  option.dataset.source.push(sourceData);\n\n  xmap.forEach((value,index)=>{\n    let data = [index];\n    yset.forEach((dimension)=>{\n      let title = index + \"|\" + dimension\n      let fValue = hybridMap.get(title)\n      if(fValue === undefined)\n      fValue = 0;\n      data.push(fValue)\n    })\n    option.dataset.source.push(data)\n  })\n\n  yset.forEach(()=>{\n    option.series.push({type: param.type})\n  })\n  return option;\n}\n\nexport default generateOption;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}